var continuallyAssetsVersion='26f75536e9ec7437abeee739aaa812b9';!function(e,t){if(void 0===e.continuallyLoaded&&(e.continuallyLoaded=1,e.continuallySettings.appID)){var n=[],i=[];window.continually_date_format="dd/mm/yyyy";var a=function(n){var i=[];if("string"==typeof n){var o=t.querySelectorAll(n);[].forEach.call(o,function(e){i.push(e)})}return"object"==typeof n&&i.push(n),a.extend=function(){for(var e=1;e<arguments.length;e++)for(var t in arguments[e])arguments[e].hasOwnProperty(t)&&(arguments[0][t]=arguments[e][t]);return arguments[0]},a.ajax=function(e){if("object"==typeof e){e.data=e.data||{};var t=(e.method||"GET").toUpperCase(),n=a.extend({"Content-type":"application/json"},e.headers||{}),i=e.url||"",o=JSON.stringify(e.data),s=e.success||function(){},r=e.error||function(){},l=new XMLHttpRequest;for(var c in l.open(t,i,!0),l.onreadystatechange=function(){if(4==l.readyState)if(l.status<400){if(void 0!==l.responseText){var e;try{e=JSON.parse(l.responseText)}catch(t){e=l.responseText}s(e,l.status,l)}}else r(l.responseText,l.status,l)},n)n.hasOwnProperty(c)&&l.setRequestHeader(c,n[c]);l.send(o)}},{attachSelectorsArray:function(e){var t=this;return e.forEach(function(e){t.attach(e)}),t},attach:function(e){"object"==typeof e&&(e=e.toArray());return i.forEach(function(t){e.forEach(function(e){t.appendChild(e)})}),this},firstSel:function(){return a(i[0])},first:function(){return i[0]},hide:function(){return i.forEach(function(e){e.style.display="none"}),this},click:function(){return i.forEach(function(e){try{e.click()}catch(e){}}),this},show:function(){return i.forEach(function(e){e.style.display="block"}),this},cxShow:function(){return i.forEach(function(e){e.setAttribute("data-cxvisible","true")}),this},cxHide:function(){return i.forEach(function(e){e.setAttribute("data-cxvisible","false")}),this},appendTo:function(e){return i.forEach(function(t){e.appendChild(t)}),this},create:function(e){return i=[t.createElement(e)],this},remove:function(){i.forEach(function(e){e.parentNode.removeChild(e)})},each:function(e){i.forEach(function(t){e(t)})},hasClass:function(e){return!(!i.length||!e)&&-1!==i[0].className.indexOf(e)},addClass:function(e){return e&&i.forEach(function(t){t.className=(t.className.replace(e,"")+" "+e).replace(/\s+/g," ").replace(/^\s+/,"").replace(/\s+$/,"")}),this},removeClass:function(e){return e&&i.forEach(function(t){t.className=t.className.replace(e," ").replace(/\s+/g," ").replace(/^\s+/,"").replace(/\s+$/,"")}),this},css:function(t){if("string"==typeof t)return this.length()?e.getComputedStyle(i[0])[t]:void 0;for(var n in t)t.hasOwnProperty(n)&&this.each(function(e){e.style[n]=t[n]});return this},on:function(e,t){return this.each(function(n){n.addEventListener?n.addEventListener(e,t,!1):n.attachEvent("on"+e,function(){return t.call(n,window.event)})}),this},removeAttr:function(e){return this.each(function(t){t.removeAttribute(e,null)}),this},html:function(e){return this.each(function(t){t.innerHTML=e}),this},appendHtml:function(e){return this.each(function(t){t.innerHTML+=e}),this},attr:function(e,t){if("object"==typeof e)for(var n in e)e.hasOwnProperty(n)&&this.each(function(t){"id"===n?t.id=e[n]:t.setAttribute(n,e[n])});else{if(void 0===t)return this.length()?i[0].getAttribute(e):void 0;this.each(function(n){"id"===e?n.id=t:n.setAttribute(e,t)})}return this},toArray:function(){return i},length:function(){return i.length}}};a();var o={main:null,settings:null,timers:[],intervals:[],tz:"",log:function(e){window.console&&window.console.log&&window.console.log(e)},error:function(e){window.console&&window.console.error&&window.console.error(e)},show:function(e){a(e).attr("data-cxvisible","true")},hide:function(e){a(e).attr("data-cxvisible","false")},showSpinner:function(){this.show("#continually-loading-conversation-history")},hideSpinner:function(){this.hide("#continually-loading-conversation-history")},clearTimersIntervals:function(){this.timers.length&&(this.timers.forEach(function(e){window.clearTimeout(e)}),this.timers=[]),this.intervals.length&&(this.intervals.forEach(function(e){window.clearInterval(e)}),this.intervals=[])},setTimeout:function(t,n){var i=e.setTimeout(t,n);return this.timers.push(i),i},setInterval:function(t,n){var i=e.setInterval(t,n);return this.intervals.push(i),i},getTestMode:function(){return!s.stored.disableTestMode&&"true"===this.getQueryVariable("continually_test")},guessTz:function(){e.Intl&&e.Intl.DateTimeFormat&&"function"==typeof e.Intl.DateTimeFormat&&e.Intl.DateTimeFormat().resolvedOptions&&"function"==typeof e.Intl.DateTimeFormat().resolvedOptions&&e.Intl.DateTimeFormat().resolvedOptions().timeZone&&(this.tz=e.Intl.DateTimeFormat().resolvedOptions().timeZone)},getYmd:function(e){var t=window.continually_date_time_localisation,n=t[0]||"dd/mm/yyyy",i=e.getFullYear(),a=e.getMonth()+1,o=a<10?"0"+a:a,s=e.getDate(),r=s<10?"0"+s:s,l=e.getDay();switch(n){case"short_en":var c=t[o];return t[13+l]+" "+r+" "+c;case"dd/mm/yyyy":return r+"/"+o+"/"+i;case"dd.mm.yyyy":return r+"."+o+"."+i;case"mm.dd.yyyy":return o+"."+r+"."+i;case"mm/dd/yyyy":return o+"/"+r+"/"+i;case"dd-mm-yyyy":return r+"-"+o+"-"+i;case"mm-dd-yyyy":return o+"-"+r+"-"+i}},getHi:function(e){var t=e.getHours(),n=t<10?"0"+t:t,i=e.getMinutes();return n+":"+(i<10?"0"+i:i)},forceSetUserIdCookie:function(e){this.readCookie(s.getCookieName())||this.createCookie(s.getCookieName(),e,365),this.readCookie(s.getCookieName())!==e&&(this.eraseCookie(s.getCookieName()),this.createCookie(s.getCookieName(),e,365))},getQueryVariable:function(e){for(var t=window.location.search.substring(1).split("&"),n=0;n<t.length;n++){var i=t[n].split("=");if(i[0]==e)return i[1]}return!1},createCookie:function(e,n,i){var a;if(i){var o=new Date;o.setTime(o.getTime()+24*i*60*60*1e3),a="; expires="+o.toGMTString()}else a="";t.cookie=e+"="+n+a+"; path=/; SameSite=Lax"},readCookie:function(e){for(var n=e+"=",i=t.cookie.split(";"),a=0;a<i.length;a++){for(var o=i[a];" "===o.charAt(0);)o=o.substring(1,o.length);if(0===o.indexOf(n))return o.substring(n.length,o.length)}return null},eraseCookie:function(e){this.createCookie(e,"",-1)},toggleHeaderVisibility:function(e){"object"==typeof e.data&&"cxHideHeader"===e.data.action?a("body").addClass("body--continually-landing-page-no-header"):"object"==typeof e.data&&"cxShowHeader"===e.data.action&&a("body").removeClass("body--continually-landing-page-no-header")},init:function(){this.timers=[],this.intervals=[],this.guessTz(),e.addEventListener("message",this.toggleHeaderVisibility.bind(this),!1)}};o.init();var s={original:{},stored:{},loadOn:"pageInteractive",url:"https://app.continual.ly/",apiUrl:"https://app.continual.ly/",delay:3500,vars:{},identity:{},defaultConversationId:null,mode:"oneConversation",getCookieName:function(){return this.stored.cookieName||"continually_user_id"},getLoadOn:function(){this.loadOn=this.original.loadOn||"pageInteractive"},getDelay:function(){this.delay=this.original.delay||3500,this.delay<300&&(this.delay=300)},parseQueryVariables:function(){for(var e=window.location.search.substring(1).split("&"),t=0;t<e.length;t++){var n=e[t].split("=");if(2===n.length)try{this.vars[n[0]]=decodeURIComponent(n[1]),0===n[0].indexOf("cx__")&&(this.identity[n[0].replace("cx__","")]=this.vars[n[0]])}catch(e){}}var i=JSON.stringify(this.identity);"string"==typeof i&&i.length>2&&(this.stored.identity||(this.stored.identity={}),this.original.identity||(this.original.identity={}),this.stored.identity=a.extend(this.stored.identity||{},this.identity),this.original.identity=a.extend(this.original.identity||{},this.identity))},detectMode:function(){var e=this;a(".continually").each(function(t){t.getAttribute("data-continually-conversation-id")&&(e.defaultConversationId=t.getAttribute("data-continually-conversation-id"),e.mode="multipleConversations",window.console&&window.console.log&&window.console.log("continually: data attribute found for bot ID `"+e.defaultConversationId+"`. Weâ€™ll skip any targeting rules and load this bot. No widget will be shown until the user clicks the custom link."))})},initFullstory:function(e){var n,i,a,o,s,r,l,c;void 0===window._fs_org&&(window._fs_is_outer_script=!0,window._fs_debug=!1,window._fs_host="fullstory.com",window._fs_org=e,window._fs_namespace="FS",n=window,i=t,a=window._fs_namespace,o="script",s="user",a in n&&n.console&&n.console.log?n.console.log('FullStory namespace conflict. Please set window["_fs_namespace"].'):((l=n[a]=function(e,t){l.q?l.q.push([e,t]):l._api(e,t)}).q=[],(r=i.createElement(o)).async=1,r.src="https://"+_fs_host+"/s/fs.js",(c=i.getElementsByTagName(o)[0]).parentNode.insertBefore(r,c),l.identify=function(e,t){l(s,{uid:e}),t&&l(s,t)},l.setUserVars=function(e){l(s,e)},l.identifyAccount=function(e,t){r="account",(t=t||{}).acctId=e,l(r,t)},l.clearUserCookie=function(e,n,a){if(!e||t.cookie.match("fs_uid=[`;`]*`[`;`]*`[`;`]*`"))for(n=i.domain;i.cookie="fs_uid=;domain="+n+";path=/;expires="+new Date(0).toUTCString(),!((a=n.indexOf("."))<0);)n=n.slice(a+1)}))},init:function(){var n=t.scripts;this.original=a.extend({delay:3500,loadOn:"pageInteractive"},e.continuallySettings||{}),this.stored=a.extend({delay:3500,loadOn:"pageInteractive"},e.continuallySettings||{},{legacyAppID:e.continuallySettings.appID}),a("#continually-container").length()&&(a("#continually-container").hasClass("no-inline")||(this.stored.alreadyHasContainer=!0,this.original.alreadyHasContainer=!0,this.stored.hideWidget=!0,this.original.hideWidget=!0,this.stored.delay=1,this.original.delay=1,this.original.fullScreen=!0,this.stored.fullScreen=!0,window.setTimeout(function(){window.continually.on("ready",function(){window.continually.startConversation()})},50))),this.getDelay(),this.getLoadOn();for(var i=0;i<n.length;i++)if(n[i].src){var o=n[i].src.match(/^(http([s]?):\/\/[a-z0-9.-]+\.continual\.ly\/)/);o&&void 0!==o[0]&&(this.url=o[0],this.apiUrl=this.url.replace("//cdn-","//"))}this.parseQueryVariables()}};s.init();var r={updateIdentityTimerId:null,conversationData:{},cx_main:null,defaultConversationData:{conversationId:null,templateId:null,lead:{id:null,name:null,email:null,phone:null,company:null},teamMember:{id:null,name:null},companyId:null,message:null,response:null,widget:{sidebarOpen:!1,isOnline:!1,widgetVisible:!1},appointment:{timeUTC:null,leadTimezone:null,companyTimezone:null,duration:null}},updateIdentity:function(e){var t=this;t.updateIdentityTimerId||(t.updateIdentityTimerId=o.setInterval(function(){t.conversationData&&t.conversationData.lead&&t.conversationData.lead.id&&(window.clearTimeout(t.updateIdentityTimerId),a.ajax({url:s.apiUrl+"api/v1/lead/update-identity/"+s.stored.appID+"/"+t.conversationData.lead.id,method:"POST",data:{identity:e},success:function(){t.updateIdentityTimerId=null},error:function(){t.updateIdentityTimerId=null}}))},1500))},set:function(e){for(var t in e)e.hasOwnProperty(t)&&-1===["url","isOnline","restartUrl"].indexOf(t)&&(this.conversationData[t]=e[t])},init:function(){this.conversationData=a.extend({},this.defaultConversationData)}};r.init(),{cxZoomImage:function(n){function i(){a("#continuallyLightbox").remove(),a("#continuallyLightboxOverlay").remove()}i(),a().create("div").attr({id:"continuallyLightboxOverlay",tabindex:"-1"}).addClass("continuallyLightboxOverlay").on("click",function(){i()}).css({width:"100vw",height:"100vh"}).appendTo(t.body),a().create("div").attr({id:"continuallyLightboxOverlay",tabindex:"-1"}).addClass("continuallyLightbox").css({top:e.pageYOffset+50+"px"}).html('<div id="continually-lb-outerContainer" class="continually-lb-outerContainer"><div class="continually-lb-data"><a id="continually-lb-close" class="continually-lb-close" style="display:none;"></a></div><div class="continually-lb-container"><img id="continually-lb-image" class="continually-lb-image" src="" alt="" style="display:none;"><div id="continually-lb-loader" class="continually-lb-loader"><a class="continually-lb-cancel"></a></div></div></div>').on("click",function(){i()}).appendTo(t.body),a(t.body).on("keydown",function(e){27===e.keyCode&&i()}),a("#continually-lb-image").on("load",function(){a("#continually-lb-loader").hide(),a("#continually-lb-close").show(),a("#continually-lb-outerContainer").css({width:this.width+"px",height:this.height+"px"}),a("#continually-lb-image").css({width:this.width+"px",height:this.height+"px"}).show()}).attr("src",n)},cxZoomHandler:function(e){"object"==typeof e.data&&"cxZoomImage"===e.data.action&&this.cxZoomImage(e.data.path)},init:function(){e.addEventListener("message",this.cxZoomHandler.bind(this),!1)}}.init();var l=null,c=[],d=!1;if("pageReady"===s.loadOn)a(window).on("load",function(e){o.setTimeout(function(){for(var e=window.location.search.substring(1).split("&"),t=0;t<e.length;t++){"continually_debug"==e[t].split("=")[0]&&o.log("continually: (pageReady) initialisation at "+new Date)}g()},s.delay)});else var u=o.setInterval(function(){if(-1!==["interactive","complete"].indexOf(t.readyState)){window.clearInterval(u);for(var e=window.location.search.substring(1).split("&"),n=0;n<e.length;n++){"continually_debug"==e[n].split("=")[0]&&o.log("continually: (pageInteractive) initialisation at "+new Date)}g()}},s.delay);var h,f=o.setInterval(function(){-1!==["interactive","complete"].indexOf(t.readyState)&&(window.clearInterval(f),function(){for(var e=t.getElementsByClassName("continually"),i=0;i<e.length;i++)e[i].onclick=function(){a(this).attr("disabled","disabled"),n.push(this)}}())},300);e.continually=(h=null,e.continuallySettings&&e.continuallySettings.ready&&"function"==typeof e.continuallySettings.ready&&(c.forEach(function(e,t){"ready"===e.type&&(h=t)}),null===h?c.push({type:"ready",callback:e.continuallySettings.ready}):c[h].callback=e.continuallySettings.ready),h=null,{on:function(e,t){var n=null;-1!==["ready","startConversation","completeConversation","sidebarOpen","sidebarClose","welcomeMessage:close","welcomeMessage:open","message","message:sent","emailCapture","nameCapture","phoneCapture","companyCapture","scheduling:requestMeeting","scheduling:meetingBooked","liveChatMessageReceived"].indexOf(e)&&void 0!==t&&(c.forEach(function(t,i){t.type===e&&(n=i)}),null===n?c.push({type:e,callback:t}):c[n].callback=t)},startConversation:function(e,t){var n=function(){if(void 0!==t&&(s.stored.appID=t),void 0!==e)o.main.switchConversation(e);else{var n=o.settings;if(s.stored.legacyConversationId&&s.stored.legacyConversationId&&n.conversation.config&&n.conversation.config.fr)if("autostart"!==n.conversation.config.fr)s.stored.appID=s.stored.legacyAppID,o.main.switchConversation(s.stored.legacyConversationId);else{var i=a("#continually-autostart-container");i.length()&&"false"===i.attr("data-cxvisible")&&(i.cxShow(),a("#continually-button-icon").cxHide(),a("#continually-button").cxHide(),a("#continually-button-text").cxHide(),a("#continually-powered-by").cxShow(),r.conversationData&&r.conversationData.widget&&(r.conversationData.widget.widgetVisible=!0))}}};null!==i?i.push(n):n()},identity:function(e){var t=function(){r.updateIdentity(e)};null!==i?i.push(t):t()},destroy:function(){var e=function(){t.body.setAttribute("data-cx-sidebar","hidden"),o.clearTimersIntervals();var e=t.getElementById("continually-container");e&&e.parentNode.removeChild(e),d=!1,n=[],i=[]};null!==i?i.push(e):e()},init:function(){g()},restart:function(){var e=this,t=function(){e.destroy(),e.init()};null!==i?i.push(t):t()},back:function(){l.togglePage(!1)}})}function g(){if(!d){d=!0;var u={iframeUrl:"",restartUrl:"",notificationSound:!1,inlineRequired:0,sidebar:null,wakeUpTimerId:0,widgetInteractionCalledOnce:!1,toggleConversationsPageTimerId:null,rememberClickOnNewMessage:!1,iframeLoaded:!1,numberUnreadLiveMessages:0,isSideBarClosed:!0,onFocusLost:!1,s:{closeBtn:null,conversationsLink:null,backLink:null,newMessages:null,newMessagesCnt:null,newMessagesLabel:null,sidebar:null,iframe:null,inner:null,container:null,conversations:null,widgetContainer:null,newMsgContainer:null,unreadMessagesCount:null},initSidebar:function(){var e=this,n=a().create("div").attr({id:"continually-close-button",title:"Close","data-cxvisible":"false"}).html('<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" class="cx-continually-inline-image" style="display:none;"><path d="M11.957 1.457L10.543.043 6 4.586 1.457.043.043 1.457 4.586 6 .043 10.543l1.414 1.414L6 7.414l4.543 4.543 1.414-1.414L7.414 6" fill="#FFF"/></svg>'),i=a().create("div").attr({id:"continually-conversations-link","data-cxvisible":"false"}).html('<svg xmlns="http://www.w3.org/2000/svg" width="6" height="10" style="    vertical-align: middle; display:none;" class="cx-continually-inline-image"><path d="M.1276 4.736l4.46-4.5962a.3593.3593 0 01.5166 0l.6015.6149a.3789.3789 0 010 .528L2.1055 5l3.6002 3.7174a.3789.3789 0 010 .528l-.6015.6148a.3593.3593 0 01-.5165 0L.1276 5.264a.3789.3789 0 010-.528z" fill="#FFF" fill-rule="nonzero"/></svg> <span id="continually-widget_conversations_link"></span><span id="continually-unread-messages-count" style="display:none"></span>'),r=a().create("div").attr({id:"continually-unread-messages-delta","data-cxvisible":"false"}).html('<span class="cx-pill"><span class="cx-label"><span id="continually-unread-messages-delta-count"></span> <span id="continually-widget_new_messages"></span></span></span>'),l=a().create("div").attr({id:"continually-sidebar"}).attachSelectorsArray([i,n,r]),c=a().create("div").attr({id:"continually-inner"}).attach(l).appendHtml('<div id="continually-button-container" data-cxvisible="false"></div><div id="continually-new-message-container" data-cxvisible="false"></div>');if(o.getTestMode()&&a("body").appendHtml('<div id="continually-report-container"></div>'),a("#continually-container").length()){(d=a("#continually-container")).attach(c),e.inlineRequired=1,a("#continually-container").hasClass("no-inline")||d.addClass("continually-container--inline")}else{var d=a().create("div").attr({id:"continually-container"}).attach(c);a(t.body).attach(d)}var u=a("#continually-sidebar").toArray()[0];a().create("iframe").attr({id:"continually-conversation-frame",title:"Chat with us",frameborder:"0",allowfullscreen:"allowfullscreen","data-cxvisible":"true"}).appendTo(u);a().create("div").attr({id:"continually-conversations-page","data-cxvisible":"false"}).appendTo(u);e.s.closeBtn=a("#continually-close-button"),e.s.conversationsLink=a("#continually-conversations-link"),e.s.newMessages=a("#continually-unread-messages-delta"),e.s.newMessagesCnt=a("#continually-unread-messages-delta-count"),e.s.newMessagesLabel=a("#continually-widget_new_messages"),e.s.sidebar=a("#continually-sidebar"),e.s.iframe=a("#continually-conversation-frame"),e.s.inner=a("#continually-inner"),e.s.container=a("#continually-container"),e.s.conversations=a("#continually-conversations-page"),e.s.widgetContainer=a("#continually-button-container"),e.s.newMsgContainer=a("#continually-new-message-container"),e.s.unreadMessagesCount=a("#continually-unread-messages-count"),e.sidebar=u,a("#continually-unread-messages-delta, #continually-conversations-link").on("click",function(){e.togglePage(!0)}),e.s.closeBtn.on("click",function(t){t.preventDefault(),t.stopPropagation(),e.s.closeBtn.cxHide(),e.closeSidebar()}),s.stored.fullScreen&&e.s.closeBtn.hide()},chgIframeSrc:function(e){var t=this.s.sidebar.first(),n=this.s.iframe.first();t.removeChild(n),s.stored.fullScreen&&(e+=(-1===e.indexOf("?")?"?":"&")+"fullScreen=1"),n.setAttribute("src",e),t.appendChild(n)},loadStyles:function(){var e=t.createElement("link"),n=t.createElement("link");e.rel="stylesheet",e.href=s.url+"css/embed/continually-embed.latest.min.css",t.head.appendChild(e),n.rel="stylesheet",n.href=s.apiUrl+"css/"+s.stored.appID+"/custom.css?1",t.head.appendChild(n)},startWithDisabledHistory:function(){this.s.conversations.html(""),a("#continually-conversations-link, #continually-conversations-page").cxHide(),a("#continually-conversation-frame").attr({"data-cxvisible":"true",allowfullscreen:"allowfullscreen","data-cx-has-history":"false"})},beep:function(){if(h.team.sound){var e=s.url+"sounds/"+h.team.sound+".wav",n=!!navigator.userAgent.match(/Trident\/7.0/),i=!!navigator.userAgent.match(/.NET4.0E/),a=n&&i,o=!!navigator.userAgent.match(/MSIE/i);if(a||o){if(!t.getElementById("continually_sound_notification")){var r=t.createElement("bgsound");r.id="continually_sound_notification",t.body.appendChild(r)}t.all.continually_sound_notification.src=e}else this.notificationSound||(this.notificationSound=new Audio(e)),this.notificationSound.play()}},isSidebarActive:function(){return"true"===this.s.sidebar.attr("data-cx-open")&&"true"===this.s.iframe.attr("data-cxvisible")},watchIfSidebarIsActive:function(){var e=this;u.messageIframe(function(){return"cxLeadActive"+(e.isSidebarActive()?"_Active":"_Inactive")},1e4)},onLooseFocus:function(e){"visible"===e&&!1===u.isSideBarClosed&&(this.numberUnreadLiveMessages=0,this.onFocusLost=!1),"hidden"===e&&(this.onFocusLost=!0),!0===e&&!1===u.isSideBarClosed&&(this.numberUnreadLiveMessages=0,this.onFocusLost=!1),!1===e&&(this.onFocusLost=!0),this.setLiveChatUnread()},watchForFocusChanged:function(){var e=this;function n(t){var n="visible",a="hidden",o={focus:n,focusin:n,pageshow:n,blur:a,focusout:a,pagehide:a};(t=t||window.event).type in o?e.onLooseFocus(o[t.type]):e.onLooseFocus(this[i]?"hidden":"visible")}var i="hidden";i in t?t.addEventListener("visibilitychange",n):(i="mozHidden")in t?t.addEventListener("mozvisibilitychange",n):(i="webkitHidden")in t?t.addEventListener("webkitvisibilitychange",n):(i="msHidden")in t?t.addEventListener("msvisibilitychange",n):"onfocusin"in t?t.onfocusin=t.onfocusout=n:window.onpageshow=window.onpagehide=window.onfocus=window.onblur=n,void 0!==t[i]&&n({type:t[i]?"blur":"focus"})},messageIframe:function(e,t){var n=this.s.iframe.first(),i=null;if(n.contentWindow,void 0!==n.contentWindow.postMessage&&"function"==typeof n.contentWindow.postMessage){var a="function"==typeof e?e():e;n.contentWindow.postMessage(a,"*"),t&&(i=o.setInterval(function(){var t="function"==typeof e?e():e;n&&(n.contentWindow,1)&&void 0!==n.contentWindow.postMessage&&"function"==typeof n.contentWindow.postMessage&&n.contentWindow.postMessage(t,"*")},t))}return i},sendWakeUpBot:function(){this.wakeUpTimerId=this.messageIframe("cxResumeSnooze",500)},botWokenUp:function(e){void 0!==e.data&&"cxResumeSnoozeStop"===e.data&&window.clearInterval(this.wakeUpTimerId)},setChatContext:function(e){this.iframeUrl=e.url,this.restartUrl=e.restartUrl,this.chgIframeSrc(this.iframeUrl),o.forceSetUserIdCookie(r.conversationData.lead.id),r.set(e),r.conversationData.widget.isOnline=e.isOnline},interactedWithWidget:function(){this.widgetInteractionCalledOnce||(this.widgetInteractionCalledOnce=!0,o.readCookie(s.getCookieName())&&h.conversation&&h.conversation.id&&a.ajax({url:s.apiUrl+"widget-interaction",method:"POST",data:{user_id:o.readCookie(s.getCookieName()),bot_id:h.conversation.id}}))},setLiveChatUnread:function(){var e,n=new RegExp("\\([0-9]+\\) ","gi");t&&void 0!==t.title&&(e=t.title.replace(n,""),(this.onFocusLost||this.isSideBarClosed)&&this.numberUnreadLiveMessages?t.title="("+u.numberUnreadLiveMessages+") "+e:t.title=e)},showContainer:function(){r.conversationData.widget.widgetVisible=!0,this.s.widgetContainer.cxShow()},closeSidebar:function(){a("html").hasClass("continually-mobile-sidebar-active")&&a("html").removeClass("continually-mobile-sidebar-active"),a("body").attr("data-cx-sidebar","hidden"),this.sidebar.setAttribute("data-cx-open","false"),r.conversationData.widget.sidebarOpen=!1,this.isSideBarClosed=!0,this.onFocusLost=!0,this.numberUnreadLiveMessages=0,this.setLiveChatUnread(),this.messageIframe("cxSidebarClosed"),v.fireEvent("sidebarClose")},showSidebar:function(){if(a("html").hasClass("continually-mobile-sidebar-active")||a("html").addClass("continually-mobile-sidebar-active"),this.numberUnreadLiveMessages=0,this.isSideBarClosed=!1,this.onFocusLost=!1,this.setLiveChatUnread(),a("body").attr("data-cx-sidebar","visible"),this.s.closeBtn.cxShow(),this.s.sidebar.attr("data-cx-open","true"),r.conversationData.widget.sidebarOpen=!0,v.fireEvent("sidebarOpen"),!this.iframeLoaded){if(this.interactedWithWidget(),g.close(),o.setTimeout(function(){null!==r.conversationData.conversationId&&v.fireEvent("startConversation")},200),this.iframeLoaded=!0,h.team.conversations_history&&h.team.conversations_html){var e=!1;h.team.conversations_history.forEach(function(t){t.templateId===h.conversation.id&&(e=!0)}),e&&this.togglePage(!0)}this.sendWakeUpBot()}},replaceWidgetWithNewMessage:function(){var e=this,t=e.s.widgetContainer.attr("data-cxvisible");h.team&&h.team.last_message&&h.team.last_message.html?(e.s.newMsgContainer.first().onclick=function(n){n.stopPropagation(),n.preventDefault();var i=h.team.last_message.id;i?h.team.conversations_history.forEach(function(n){n.conversationId===i&&(e.iframeUrl&&-1!==n.url.indexOf(e.iframeUrl)||(e.rememberClickOnNewMessage=!0,e.chgIframeSrc(s.apiUrl+"chat/empty-state"),e.setChatContext(n)),e.showSidebar(),e.togglePage(!1)),e.s.newMsgContainer.html("").cxHide().first().onclick=function(e){return!1},e.s.widgetContainer.attr("data-cxvisible",t)}):(e.showSidebar(),e.s.newMsgContainer.html("").cxHide().first().onclick=function(e){return!1},e.s.widgetContainer.attr("data-cxvisible",t))},e.s.newMsgContainer.html(h.team.last_message.html).attr("data-conversation_id",h.team.last_message.id).cxShow(),e.s.widgetContainer.cxHide(),u.beep()):(e.s.newMsgContainer.html("").cxHide().first().onclick=function(e){return!1},e.s.widgetContainer.attr("data-cxvisible",t))},togglePage:function(e){var t=e?"true":"false",n=e?"false":"true";a("#continually-conversations-page").attr("data-cxvisible",t),a("#continually-conversations-link, #continually-conversation-frame").attr("data-cxvisible",n),a("#continually-conversation-frame").attr("allowfullscreen","allowfullscreen"),this.toggleConversationsPageTimerId&&window.clearTimeout(this.toggleConversationsPageTimerId);var i=500;!1===e?(i=5e3,this.messageIframe("cxOpenChat")):(this.messageIframe("cxOpenConversations"),o.showSpinner()),this.toggleConversationsPageTimerId=o.setTimeout(function(){h.getTeamSettings()},i)},reloadOrCloseRequired:function(e){void 0!==e.data&&"cxReloadConversation"===e.data&&this.restartUrl&&(this.chgIframeSrc(this.restartUrl),this.sendWakeUpBot()),void 0!==e.data&&"cxCloseConversation"===e.data&&this.s.closeBtn.click()},guestRegister:function(){var e=this,t={referrer:window.location.href},n=s.apiUrl+"api/v1/leads/guest/"+s.stored.appID+"/"+h.conversation.id;g.autoStartAnswer&&(t.autoStartAnswerValue=g.autoStartAnswer,g.autoStartAnswer=null),t.identity=s.stored.identity,o.readCookie(s.getCookieName())&&(n+="?user_id="+o.readCookie(s.getCookieName())),h.conversation.id&&a.ajax({url:n,method:"POST",data:t,success:function(t){try{if(t&&void 0!==t.url)return void(e.rememberClickOnNewMessage?e.rememberClickOnNewMessage=!1:e.setChatContext(t))}catch(e){}e.chgIframeSrc(s.apiUrl+"chat/failed-state/"+s.stored.appID)},error:function(){e.chgIframeSrc(s.apiUrl+"chat/failed-state/"+s.stored.appID)}})},switchConversation:function(e){var t=this;(h.conversation.id!==e||s.stored.hideWidget)&&(h.conversation.id=e,t.iframeUrl=null,t.chgIframeSrc(s.apiUrl+"chat/empty-state"),t.iframeLoaded=!1,t.guestRegister()),o.setTimeout(function(){t.showSidebar()},500)},init:function(){var e=this;e.initSidebar(),window.addEventListener("message",function(t){e.reloadOrCloseRequired(t)},!1),window.addEventListener("message",function(t){e.botWokenUp(t)},!1),o.main=e}},h={team:null,conversation:null,overrideConversation:null,teamTimerId:null,setLocalisationOnce:!1,teamSettingsRequestOnceSent:!1,settingsReadySubscribers:[],teamSettingsOnceProcessed:!1,spType:function(){return this.conversation.sp.type},typeIs:function(e){return"string"==typeof e?e===this.conversation.sp.type:-1!==e.indexOf(this.conversation.sp.type)},checkIfSpIsInteractive:function(){return this.conversation.sp.isInteractiveType=-1!==["email","name","company","phone","gdpr","multiple_choice","multiple_checkbox","radio","likert","textarea"].indexOf(this.conversation.sp.type),this.conversation.sp.isInteractiveType},widgetAppearsOn:function(){return this.conversation.config.sc},format:function(){return this.conversation.config.fr},formatIs:function(e){return"string"==typeof e?e===this.conversation.config.fr:-1!==e.indexOf(this.conversation.config.fr)},getWidgetPosClass:function(){return this.conversation&&this.conversation.widget_pos_class?this.conversation.widget_pos_class:""},parseConversationSettings:function(n){var i=this,l="string"==typeof n?JSON.parse(n):n;if(l&&void 0!==l.user_id&&o.forceSetUserIdCookie(l.user_id),l.data){i.conversation=l.data,o.getTestMode()&&i.conversation.test_report&&a("#continually-report-container").html(i.conversation.test_report),s.stored.legacyConversationId=i.conversation.id;var c=t.createElement("style");c.innerHTML=l.data.css,t.head.appendChild(c),i.conversation.widgetHTML?u.s.widgetContainer.appendHtml(i.conversation.widgetHTML):i.conversation.config.fr="btn",o.setTimeout(function(){i.conversation.conversationData&&r.set(i.conversation.conversationData),s.stored.hideWidget||(g.prepareContainer(),u.replaceWidgetWithNewMessage()),v.fireEvent("ready",e.continually),o.setTimeout(function(){v.fireEvent("welcomeMessage:open")},100)},100)}},getConversation:function(){var e=this;if("undefined"!=typeof overrideContinuallyConversationSettings)e.parseConversationSettings(overrideContinuallyConversationSettings);else{var n={url:encodeURIComponent(window.location.href),referrer:t.referrer?encodeURIComponent(t.referrer):null,identity:s.stored.identity,tz:o.tz,inlineRequired:u.inlineRequired};o.readCookie(s.getCookieName())&&(n.user_id=o.readCookie(s.getCookieName())),o.getTestMode()&&(n.continually_test=!0),a.ajax({url:s.apiUrl+"conversation/"+s.stored.appID,method:"POST",data:n,success:function(t){e.parseConversationSettings(t)}})}},parseTeamSettings:function(e){var t=this,n="string"==typeof e?JSON.parse(e):e;if(n.assets_wrong_version&&o.error(n.assets_wrong_version),n.page_views_limit_exceeded&&o.log("You've exceeded free plan page views limit"),n.page_views_daily_limit_exceeded&&o.log("Subscription limit: your account has exceeded a daily limit on page views"),n.data){void 0!==n.data.user_id&&o.forceSetUserIdCookie(n.data.user_id);var i=0;if(t.team&&void 0!==t.team.unread_messages_count&&(i=n.data.unread_messages_count-t.team.unread_messages_count),!t.setLocalisationOnce)for(var r in t.setLocalisationOnce=!0,n.data.widget_localisation)n.data.widget_localisation.hasOwnProperty(r)&&a("#continually-"+r).html(n.data.widget_localisation[r]);if(t.team=n.data,t.teamSettingsOnceProcessed||(window.continually_date_time_localisation=t.team.date_time_localisation,t.team.fullstory.is_enabled&&s.initFullstory(t.team.fullstory.org_id),2===t.team.ga_enabled&&t.team.ga_tracker_id&&(s.stored.googleAnalyticsTrackerId=t.team.ga_tracker_id),0===t.team.ga_enabled&&(s.stored.disableGoogleAnalyticsTracking=!0),t.getConversation(),void 0!==t.team.conversations_history&&o.setTimeout(function(){f.createChannel()},150),t.team.sidebar_pos_class&&u.s.sidebar.addClass(t.team.sidebar_pos_class)),t.team.conversations_history&&t.team.conversations_html){if(a("#continually-conversations-link").length()){var l=t.team.conversations_html;if(t.team.utc_today){var c=Date.parse(t.team.utc_today);isNaN(c)&&(c=Date.parse(t.team.utc_today.replace(" ","T")));var d=o.getYmd(new Date(c)),h=l.match(/data-continually-ccit="date"\>([^\<]+)\</g);h&&h.forEach(function(e){var t=e.replace('data-continually-ccit="date">',"").replace("<",""),n=Date.parse(t);isNaN(n)&&(n=Date.parse(t.replace(" ","T")));var i=new Date(n),a=o.getYmd(i);l=d===a?l.split(e).join('data-continually-ccit="date">'+o.getHi(i)+"<"):l.split(e).join('data-continually-ccit="date">'+a+"<")})}u.s.conversations.html(l),t.team.conversations_history.length&&"true"!==u.s.conversations.attr("data-cxvisible")&&(u.s.conversationsLink.cxShow(),u.s.iframe.attr({"data-cx-has-history":"true",allowfullscreen:"allowfullscreen"})),t.team.unread_messages_count?u.s.unreadMessagesCount.html("").css({display:null}):u.s.unreadMessagesCount.html("").css({display:"none"}),a("#continually-create-new-conversation").on("click",function(){var e=a(this).attr("data-bot-id");e&&(u.switchConversation(e),u.togglePage(!1))}),a("[data-role='continually-conversation-item']").on("click",function(e){e.stopPropagation(),e.preventDefault();var n=a(e.target.parentNode).attr("data-continually-conversation-id");n&&t.team.conversations_history.forEach(function(e){e.conversationId===n&&(-1===e.url.indexOf(u.iframeUrl)&&(u.chgIframeSrc(s.apiUrl+"chat/empty-state"),u.setChatContext(e)),u.togglePage(!1))})}),i>0&&(u.s.newMessagesCnt.cxShow(),o.setTimeout(function(){u.s.newMessagesCnt.cxHide()},7e3),u.replaceWidgetWithNewMessage())}}else u.startWithDisabledHistory();t.teamSettingsOnceProcessed=!0}o.hideSpinner(),a(".cx-continually-inline-image").css({display:""})},getTeamSettings:function(){var e=this;o.showSpinner(),e.teamTimerId&&window.clearTimeout(e.teamTimerId),e.teamTimerId=o.setTimeout(function(){var t={assetsVersion:window.continuallyAssetsVersion||""};o.readCookie(s.getCookieName())&&(t.user_id=o.readCookie(s.getCookieName())),s.stored.fullScreen&&(t.fullScreen=!0),e.teamSettingsRequestOnceSent||(e.teamSettingsRequestOnceSent=!0,t.tUrl=window.location.href,t.ga_tracker_id=v.getPossibleTracker()),a.ajax({url:s.apiUrl+"team-settings/"+s.stored.appID,method:"POST",data:t,success:function(t,n,i){e.parseTeamSettings(t)},error:function(e,t,n){503===t&&window.console&&window.console.log&&window.console.log("Continually is under maintenance, the ETA is "+n.getResponseHeader("x-eta"))}})},100)},subscribeSettingsReady:function(e){this.settingsReadySubscribers.push(e)},processSettingsReadySubscribers:function(){this.settingsReadySubscribers.forEach(function(e){e()})},init:function(){this.teamSettingsRequestOnceSent=!1,"multipleConversations"===s.mode&&void 0===e.overrideContinuallyConversationSettings&&(this.overrideConversation={data:{id:s.defaultConversationId,css:"",config:{fr:"hidden"},sp:{}}}),o.settings=this}},f={createChannel:function(){if(h.team&&h.team.channel_history_prefix){var e=o.readCookie(s.getCookieName()),t=s.stored.appID;if(e&&t){var n=Date.now()+Math.random(),i=h.team.wssUrl,a=new XMLHttpRequest;try{a.onload=function(){if(a.responseText){var s=a.responseText.match(/"sid":"([^"]+)"/);if(s&&s.length&&2===s.length){var r=s[1],l=new XMLHttpRequest,c="conversation_history."+h.team.channel_history_prefix+"."+e+"."+t;l.onload=function(){if(l.responseText&&"ok"===l.responseText){var e=new WebSocket("wss://"+i.replace(/https?:\/\//,"")+"websocket&sid="+r);e.onopen=function(){e.send("2probe")},e.onmessage=function(t){if(t&&t.data&&("3probe"===t.data&&(e.send("5"),o.setInterval(function(){e.send("2")},25e3)),"string"==typeof t.data&&-1!==t.data.indexOf(c)&&-1!==t.data.indexOf("conversation_history_update_required"))){var n=t.data.match(/"requiredBy":"([^"]+)"/);n&&n.length&&2===n.length&&u.isSidebarActive()?h.team.conversations_history&&h.team.conversations_history.length&&h.team.conversations_history.forEach(function(e){e.conversationId===n[1]&&-1===e.url.indexOf(u.iframeUrl)&&h.getTeamSettings()}):h.getTeamSettings()}}}},l.open("POST",i+"polling&t="+n+"_1&sid="+r,!0),l.setRequestHeader("Accept","*/*"),l.send('82:42["subscribe",{"channel":"'+c+'"}]')}}},a.open("GET",i+"polling&t="+n,!0),a.setRequestHeader("Accept","*/*"),a.send()}catch(e){}}}},init:function(){}},g={autoStartAnswer:"",close:function(){a("#close-continually-message-button").click()},setContinuallyClickHandlers:function(){for(var e=t.getElementsByClassName("continually"),n=0;n<e.length;n++){var i=e[n];"oneConversation"===s.mode?i.onclick=m:i.getAttribute("data-continually-conversation-id")?i.onclick=w:i.onclick=m}},prepareContainer:function(){var e=this,n=!0;if(e.setContinuallyClickHandlers(),u.s.widgetContainer.addClass(h.getWidgetPosClass()),a("#close-continually-message-button").on("click",function(e){e.preventDefault(),e.stopPropagation(),u.interactedWithWidget();var t="msg"===h.format()?"#continually-message-container":"#continually-autostart-container";a(t).cxHide(),a("#continually-powered-by").cxHide(),a("#continually-button-text").cxHide(),a("#continually-button-icon").cxShow(),a("#continually-button").cxShow().attr("data-cxlayout","i"),r.conversationData.widget.widgetVisible=!1,v.fireEvent("welcomeMessage:close")}),h.formatIs(["msg","autostart","btn"])){var i=h.widgetAppearsOn();if("i"===i)u.showContainer();else if("h"===i){var s;a(window).on("scroll",function(){var e=t.documentElement;(window.pageYOffset||e.scrollTop)-(e.clientTop||0)>t.body.getBoundingClientRect().height/2&&!s&&(s=!0,u.showContainer())})}else{var l=parseInt((h.conversation.config.t+"").replace(/[^\d]/,""),10);isNaN(l)&&(l=0),o.setTimeout(function(){u.showContainer()},1e3*l)}}if((h.conversation&&h.conversation.sp&&h.conversation.sp.type&&"team_notification"===h.conversation.sp.type&&(n=!1),h.formatIs("autostart"))&&(h.conversation.sp&&h.conversation.sp.type&&h.checkIfSpIsInteractive())){n=!1,h.typeIs(["email","name","company","phone","textarea"])&&a("[data-role='continually-answer-input']").firstSel().on("keyup",function(t){e.autoStartAnswer=this.value,13!==t.keyCode||t.shiftKey||a(".continually").firstSel().click()});var c=a("#continually-send-multiple-checkbox").css({"pointer-events":"auto"}).on("click",function(e){e.preventDefault(),e.stopPropagation(),c.hasClass("disabled")||a(".continually").firstSel().click()});a("[data-role='continually_multiple_checkbox']").on("click",function(t){t.preventDefault(),t.stopPropagation();var n=t.target.getAttribute("data-hash"),i="#"+n+"#",o=a("#continually-answer-"+n);(o.hasClass("checked")?(o.removeClass("checked"),e.autoStartAnswer=e.autoStartAnswer.replace(i,"")):(o.addClass("checked"),e.autoStartAnswer+=i),c.addClass("disabled"),"1"===h.conversation.sp.restrict_number_of_answers)?a(".checked[data-role='continually_multiple_checkbox']").length()<=parseInt(h.conversation.sp.number_of_answers_allowed)&&c.removeClass("disabled"):e.autoStartAnswer&&c.removeClass("disabled")}),a("[data-role='continually_radio']").on("click",function(t){var n=t.target.getAttribute("data-hash");t.preventDefault(),t.stopPropagation(),e.autoStartAnswer="#"+n+"#",a(".continually").firstSel().click()})}n&&h.processSettingsReadySubscribers()},init:function(){}},v={isFSIdentifyCalled:!1,isContinuallyGetGAObjectCalled:!1,continuallyGAObject:null,continuallyGAObjectOnceDiscovered:!1,gaTrackerUsed:null,getPossibleTracker:function(){if(e.GoogleAnalyticsObject){var t=e.gaData,n=null;if(t){for(var i in t)t.hasOwnProperty(i)&&t[i].hasOwnProperty("hitcount")&&(n=i);if(n&&0===n.indexOf("UA-"))return n}}},continuallyGetGAObject:function(){if(this.isContinuallyGetGAObjectCalled=!0,this.continuallyGAObject)return this.continuallyGAObject;if(this.continuallyGAObjectOnceDiscovered)return this.continuallyGAObject;if(this.continuallyGAObjectOnceDiscovered=!0,e.GoogleAnalyticsObject){var t=e.gaData,n=null;if(t){for(var i in t)t.hasOwnProperty(i)&&t[i].hasOwnProperty("hitcount")&&(n=i);var a=e[e.GoogleAnalyticsObject];s.stored.googleAnalyticsTrackerId?(this.continuallyGAObject=a,this.continuallyGAObject("create",s.stored.googleAnalyticsTrackerId,"auto","continuallyGATracker"),this.gaTrackerUsed=s.stored.googleAnalyticsTrackerId):n&&0===n.indexOf("UA-")&&(this.continuallyGAObject=a,this.continuallyGAObject("create",n,"auto","continuallyGATracker"),this.gaTrackerUsed=n)}}return this.continuallyGAObject},fireEvent:function(e,t){var o={};if(void 0===t)for(var l in r.conversationData)r.conversationData.hasOwnProperty(l)&&(o[l]=r.conversationData[l]);else o=t;if(!s.stored.disableGoogleAnalyticsTracking&&-1!==["welcomeMessage:open","startConversation","emailCapture","phoneCapture","scheduling:meetingBooked"].indexOf(e)){var d=this.continuallyGetGAObject();if(d)switch(e){case"welcomeMessage:open":d("continuallyGATracker.send","event",{eventCategory:"Continually Conversations",eventAction:"Widget shown",nonInteraction:!0,eventLabel:null});break;case"startConversation":d("continuallyGATracker.send","event",{eventCategory:"Continually Conversations",eventAction:"Started Conversation",eventLabel:o.conversationId});break;case"emailCapture":d("continuallyGATracker.send","event",{eventCategory:"Continually Conversations",eventAction:"Email captured",eventLabel:o.conversationId});break;case"phoneCapture":d("continuallyGATracker.send","event",{eventCategory:"Continually Conversations",eventAction:"Phone captured",eventLabel:o.conversationId});break;case"scheduling:meetingBooked":d("continuallyGATracker.send","event",{eventCategory:"Continually Conversations",eventAction:"Appointment booked",eventLabel:o.conversationId})}}if("ready"===e){if(n&&n.length&&(n.forEach(function(e){a(e).removeAttr("disabled")}),n[0].click()),n=[],i&&i.length)for(var u=0;u<i.length;u++)i[u]();i=null}c.forEach(function(t){t.type===e&&t.callback(o)})},handleIframeMessage:function(e){var t={};for(var n in e.data)e.data.hasOwnProperty(n)&&(t[n]=e.data[n]);void 0!==t.type&&void 0!==t.lead&&(h.team.fullstory.is_enabled&&void 0!==window._fs_org&&FS&&(this.isFSIdentifyCalled?FS.setUserVars({uid:t.lead.id,displayName:t.lead.name,email:t.lead.email,company_str:t.lead.company}):(this.isFSIdentifyCalled=!0,FS.identify(t.lead.id,{displayName:t.lead.name,email:t.lead.email,company_str:t.lead.company}))),-1!==["message","message:sent","emailCapture","nameCapture","phoneCapture","companyCapture","completeConversation","scheduling:requestMeeting","scheduling:meetingBooked","liveChatMessageReceived"].indexOf(t.type)&&(r.conversationData.lead=t.lead,r.conversationData.message=t.message,r.conversationData.response=t.response,o.forceSetUserIdCookie(t.lead.id),"scheduling:meetingBooked"===t.type&&void 0!==t.meeting&&(r.conversationData.appointment.timeUTC=t.meeting.timeUTC,r.conversationData.appointment.companyTimezone=t.meeting.companyTimezone,r.conversationData.appointment.leadTimezone=t.meeting.leadTimezone,r.conversationData.appointment.duration=t.meeting.duration),"liveChatMessageReceived"===t.type&&(u.onFocusLost?(u.beep(),u.numberUnreadLiveMessages++):u.numberUnreadLiveMessages=0,u.setLiveChatUnread()),this.fireEvent(t.type)))},init:function(){var e=this;e.isFSIdentifyCalled=!1,e.isContinuallyGetGAObjectCalled=!1,e.continuallyGAObject=null,e.continuallyGAObjectOnceDiscovered=!1,e.gaTrackerUsed=null,window.addEventListener("message",function(t){e.handleIframeMessage(t)},!1)}};u.loadStyles(),r.init(),s.init(),o.init(),u.init(),s.detectMode(),h.init(),f.init(),g.init(),v.init(),h.getTeamSettings(),u.chgIframeSrc(s.apiUrl+"chat/empty-state"),l=u;var p=!1,y=!1,m=function(e){if(e.preventDefault(),e.stopPropagation(),"INPUT"===e.target.nodeName)return!1;if(h.conversation.id===s.stored.legacyConversationId){if(h.conversation.sp&&h.conversation.sp.isInteractiveType){var n=t.getElementById("continually-email-validation-form");if(n&&!n.checkValidity())return!1;var i=t.getElementById("continually-autostart-actions");i&&(i.parentNode.removeChild(i),g.close()),p||(p=!0,u.guestRegister())}h.conversation.sp&&h.conversation.sp.type&&"team_notification"===h.conversation.sp.type&&(y||(y=!0,u.guestRegister())),u.showSidebar()}else s.stored.appID=s.stored.legacyAppID,u.switchConversation(s.stored.legacyConversationId)},w=function(e){e.preventDefault(),e.stopPropagation();for(var t=e.target;!t.getAttribute("data-continually-conversation-id");)t=t.parentNode;t.getAttribute("data-continually-app-id")?s.stored.appID=t.getAttribute("data-continually-app-id"):s.stored.appID=s.stored.legacyAppID,u.switchConversation(t.getAttribute("data-continually-conversation-id"))},b=o.getQueryVariable("continually_open");if("string"==typeof b&&b.length&&(b.match(/^[0-9a-z]{12}$/)||b.match(/^[0-9a-z]{12},[0-9a-z]{12}$/))){var C=b.split(","),S=C[0],_=2===C.length?C[1]:null;_&&(s.stored.appID=_),h.subscribeSettingsReady(function(){u.switchConversation(S)})}else h.subscribeSettingsReady(function(){u.guestRegister()}),"true"!=b&&"1"!=b&&"yes"!=b||h.subscribeSettingsReady(function(){u.showSidebar()});u.watchIfSidebarIsActive(),u.watchForFocusChanged()}}}(this,document);